apply plugin: 'groovy'
apply plugin: 'code-quality'
apply plugin: 'eclipse'
apply plugin: 'idea'

version = '1.0-SNAPSHOT'
group = 'tonybaines.testnarc'
manifest.mainAttributes(
  'Main-Class': 'tonybaines.testnarc.Execute',
  'Application-Name': 'Test-narc',
  'Version': version
)

eclipseClasspath.outputDirectory ='ide/build'
// Stop codenarc warnings from failing the build
codenarcMain.ignoreFailures = true
codenarcTest.ignoreFailures = true


repositories {
    mavenCentral()
}

dependencies {
  groovy 'org.codehaus.groovy:groovy:1.7.5'
  compile ('log4j:log4j:1.2.16'
          ,'commons-logging:commons-logging:1.1.1')
  testCompile ('org.spockframework:spock-core:0.4-groovy-1.7')
}

jar {
  from configurations.runtime.collect { it.isDirectory() ? it : zipTree(it) }
}

//task setVersion << {
//    ant.echo(file: 'src/main/groovy/com/bt/buildstatscollector/Version.groovy',
//            message: """
//package com.bt.buildstatscollector
///*AUTO-GENERATED FILE - DO NOT VERSION CONTROL*/
//public class Version{
//    public static final String VERSION = '${version}'
//}""")
//}
//compileGroovy.dependsOn(setVersion)
